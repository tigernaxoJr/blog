<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Database on YuCheng&#39;s Site</title>
    <link>https://tigernaxojr.github.io/blog/posts/database/</link>
    <description>Recent content in Database on YuCheng&#39;s Site</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 14 Jun 2022 00:20:00 +0800</lastBuildDate><atom:link href="https://tigernaxojr.github.io/blog/posts/database/index.xml" rel="self" type="application/rss+xml" /><item>
      <title>[SQL] MERGE</title>
      <link>https://tigernaxojr.github.io/blog/posts/database/sql-merge/</link>
      <pubDate>Tue, 14 Jun 2022 00:20:00 +0800</pubDate>
      
      <guid>https://tigernaxojr.github.io/blog/posts/database/sql-merge/</guid>
      <description>一段神奇的語法，可以指定對舊資料、新的資料分別進行不同的動作(通常是更新、新增)， 不指定的話預設是 BY TARGET， 動作目標都是 TARGET。
在更新清單的時候特別好用。
MERGE INTO  DETAIL AS TARGET -- 目標表格  USING ( VALUES (@k1, @k2, @k3, @f1)) AS SOURCE (k1, k2, k3, f1) -- 資料來源  ON SOURCE.k1 = TARGET.k1 AND SOURCE.k2 = TARGET.k2 AND SOURCE.k3 = TARGET.k3 -- 兩造欄位核對條件 -- TARGET 有，SOURCE 也有，SOURCE 更新到 TARGET WHEN MATCHED THEN -- 以 TARGET 為目標，更新 SOURCE 裡面被 TARGET 對應(BY TARGET)的資料?(這邊 BY 哪裡都一樣)  UPDATE SET f1 = SOURCE.</description>
    </item>
    
    <item>
      <title>[SQL] 用 CTE (Common Table Expression) 達成遞迴查詢，建立 MenuTree</title>
      <link>https://tigernaxojr.github.io/blog/posts/database/sql-cte/</link>
      <pubDate>Mon, 25 Apr 2022 06:26:00 +0800</pubDate>
      
      <guid>https://tigernaxojr.github.io/blog/posts/database/sql-cte/</guid>
      <description>建立一個暫存表 testCTE，並暫存查詢語句(所有資料)的結果 MSSQL CTE 名稱前不需加上 RECURSEIVE 關鍵字，必須使用 UNION ALL PostgreSQL：CTE 名稱前需加上 RECURSIVE 關鍵字，可用 UNION 或 UNION ALL
WITH CTE (id, name, parentId, lvl) AS (  -- 取得第一層的資料(Anchor member)(假設沒有 parentId 的是第一層)  SELECT id, name parentId, 0 AS lvl FROM menus WHERE parentId IS NULL  UNION ALL  -- 遞迴取得 Recursive member  (  SELECT A.id, A.name, A.parentId, CTE.lvl + 1 AS lvl FROM menus A  INNER JOIN CTE B on A.</description>
    </item>
    
    
  </channel>
</rss>
